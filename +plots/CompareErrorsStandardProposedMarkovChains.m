clear all;

initParam;

switch param.malware
    
    case 'SIS'
        
        load(strcat('sis_error_a', num2str(param.alpha*100),'_b',num2str(param.beta*100),'_standard.mat'));
        res_sim = data_sim(:,2);
        res_std = data_mc(:,1);
        error_std = error_Susceptible;

        load(strcat('sis_error_a', num2str(param.alpha*100),'_b',num2str(param.beta*100),'_proposed.mat'));
        res_prop = data_mc(:,1);
        error_prop = error_Susceptible;
        
        
        f = figure(150);
        plot((0:param.max_turns)',100*report(1:end,2)/param.n, 'blue', 'LineWidth', 2);
        hold on;
        plot((0:param.max_turns)',100*report(1:end,3)/param.n, 'red--', 'LineWidth', 2);
        hold off;
        ytickformat('percentage');
        xlabel('Turn');
        ylabel('Percentage of Total Devices');
        % axis([0 1 0 1]);
        axis([0 param.max_turns 0 100]);
        legend('Susceptible', 'Infected', 'Location', 'North');
%         title(strcat('SIS simulation (all populations), \alpha=', num2str(param.alpha)));
        xlabel('Turn');
        ylabel('Percentage of Total Devices');
        exportgraphics(f,strcat('Paper_sis_simulation_a', num2str(param.alpha*100),'_b',num2str(param.beta*100),'.png'), 'Resolution', 600);


        f = figure(151);
        plot((0:param.max_turns)',100*res_prop, 'blue', 'LineWidth', 5);
        hold on
        plot((0:param.max_turns)',100*res_std, 'black:', 'LineWidth', 2);
%         plot((0:param.max_turns)',100*res_lin, 'blue-.', 'LineWidth', 1);
%         plot((0:param.max_turns)',100*res_sim, 'color',[0 0.5 0], 'LineStyle',':', 'LineWidth', 2);
        plot((0:param.max_turns)',100*res_sim, 'green--', 'LineWidth', 2);
        hold off
        ytickformat('percentage');
%         axis([0 param.max_turns 50 100]);
        legend('Proposed Model', 'Standard Model', 'Numerical Simulation', 'Location', 'North');
%         title(strcat('SIS: S population, \alpha=',num2str(param.alpha)));
        xlabel('Turn');
        ylabel('Percentage of Total Devices');
        exportgraphics(f,strcat('Paper_sis_compare_a', num2str(param.alpha*100),'_b',num2str(param.beta*100),'.png'), 'Resolution', 600);

        f = figure(152);
        plot((0:param.max_turns)',abs(100*error_prop), 'blue', 'LineWidth', 4);
%         plot((0:param.max_turns)',100*error_prop, 'red', 'LineWidth', 3);
        hold on;
        plot((0:param.max_turns)',100*error_std, 'black:', 'LineWidth', 2);
%         plot((0:param.max_turns)',100*error_lin, 'blue-.', 'LineWidth', 1);
        hold off
        ytickformat('percentage');
%         set(gca, 'YScale', 'log')
%         plot((0:param.max_turns)',100*zeros(1,param.max_turns+1), 'green', 'LineWidth', 2);
        axis([0 param.max_turns -1 11]);
        legend('Proposed Model', 'Standard Model', 'Location', 'East');
%         title(strcat('SIS: S error between simulation and DTMC, \alpha=',num2str(param.alpha)));
        xlabel('Turn');
        ylabel('Percentage of Total Devices');
        exportgraphics(f,strcat('Paper_sis_error_a', num2str(param.alpha*100),'_b',num2str(param.beta*100),'.png'), 'Resolution', 600);
        
        clearvars f;
        
    case 'SEIRS'
   
        load('seirs_error_a90_b45_standard.mat');
        res_sim = data_sim(:,2);
        res_std = data_mc(:,1);
        error_std = error_Susceptible;

        load('seirs_error_a90_b45_proposed.mat');
        res_prop = data_mc(:,1);
        error_prop = error_Susceptible;
        
        f = figure(150);
        plot((0:param.max_turns)',100*report(1:end,2)/param.n, 'blue', 'LineWidth', 2);
        hold on;
        plot((0:param.max_turns)',100*report(1:end,3)/param.n, '-.', 'color',[1 0.5 0], 'LineWidth', 2)
        plot((0:param.max_turns)',100*report(1:end,4)/param.n, 'red--', 'LineWidth', 2)
        plot((0:param.max_turns)',100*report(1:end,5)/param.n, ':', 'color',[0 0.5 0], 'LineWidth', 2)        
        hold off;
        ytickformat('percentage');
        xlabel('Turn');
        ylabel('Percentage of Total Devices');
        % axis([0 1 0 1]);
        axis([0 param.max_turns 0 100]);
        legend('Susceptible','Exposed', 'Infected', 'Recovered');
%         title(strcat('SEIRS simulation (all populations), \alpha=', num2str(param.alpha)));
        xlabel('Turn');
        ylabel('Percentage of Total Devices');
        exportgraphics(f,strcat('Paper_seirs_simulation_a', num2str(param.alpha*100),'_b',num2str(param.beta*100),'.png'), 'Resolution', 600);


        f = figure(151);
        plot((0:param.max_turns)',100*res_prop, 'blue', 'LineWidth', 5);
        hold on
        plot((0:param.max_turns)',100*res_std, 'black:', 'LineWidth', 2);
%         plot((0:param.max_turns)',100*res_lin, 'blue-.', 'LineWidth', 1);
%         plot((0:param.max_turns)',100*res_sim, 'color',[0 0.5 0], 'LineStyle',':', 'LineWidth', 2);
        plot((0:param.max_turns)',100*res_sim, 'green--', 'LineWidth', 2);
        hold off
        ytickformat('percentage');
%         axis([0 param.max_turns 50 100]);
        legend('Proposed Model', 'Standard Model', 'Numerical Simulation', 'Location', 'North');
%         title(strcat('SEIRS: S population, \alpha=',num2str(param.alpha)));
        xlabel('Turn');
        ylabel('Percentage of Total Devices');
        exportgraphics(f,strcat('Paper_seirs_compare_a', num2str(param.alpha*100),'_b',num2str(param.beta*100),'.png'), 'Resolution', 600);

        f = figure(152);
        plot((0:param.max_turns)',abs(100*error_prop), 'blue', 'LineWidth', 4);
%         plot((0:param.max_turns)',100*error_prop, 'red', 'LineWidth', 3);
        hold on;
        plot((0:param.max_turns)',100*error_std, 'black:', 'LineWidth', 2);
%         plot((0:param.max_turns)',100*error_lin, 'blue-.', 'LineWidth', 1);
        hold off
        ytickformat('percentage');
%         set(gca, 'YScale', 'log')
%         plot((0:param.max_turns)',100*zeros(1,param.max_turns+1), 'green', 'LineWidth', 2);
        axis([0 param.max_turns -1 11]);
        legend('Proposed Model', 'Standard Model', 'Location', 'East');
%         title(strcat('SEIRS: S error between simulation and DTMC, \alpha=',num2str(param.alpha)));
        xlabel('Turn');
        ylabel('Percentage of Total Devices');
        exportgraphics(f,strcat('Paper_seirs_error_a', num2str(param.alpha*100),'_b',num2str(param.beta*100),'.png'), 'Resolution', 600);
        
        clearvars f;
        
    case '2SEIS'

        load('2seis_error_a90_b45_standard.mat');
        res_sim = (data_sim(:,5)+data_sim(:,6));
        res_std = (data_mc(:,1)+data_mc(:,3));
        error_std = error_Susceptible;

        load('2seis_error_a90_b45_proposed.mat');
        res_prop = (data_mc(:,1)+data_mc(:,3));
        error_prop = error_Susceptible;
        
        f = figure(150);
        plot((0:param.max_turns)',100*report(1:end,2)/param.n, 'blue', 'LineWidth', 2);
        hold on;
        plot((0:param.max_turns)',100*report(1:end,3)/param.n, '-.', 'color',[1 0.5 0], 'LineWidth', 2)
        plot((0:param.max_turns)',100*report(1:end,4)/param.n, 'red--', 'LineWidth', 2)
        plot((0:param.max_turns)',100*report(1:end,5)/param.n, ':', 'color',[0 0.5 0], 'LineWidth', 1.2)
        plot((0:param.max_turns)',100*report(1:end,6)/param.n, 'black:', 'LineWidth', 1.2)
        hold off;
        ytickformat('percentage');
        xlabel('Turn');
        ylabel('Percentage of Total Devices');
        % axis([0 1 0 1]);
        axis([0 param.max_turns 0 100]);
        legend('Susceptible Total','Exposed', 'Infected Total', 'Susceptible CCTV', 'Susceptible Mobile');
%         title(strcat('2SEIS simulation (all populations), \alpha=', num2str(param.alpha)));
        xlabel('Turn');
        ylabel('Percentage of Total Devices');
        exportgraphics(f,strcat('Paper_2seis_simulation_a', num2str(param.alpha*100),'_b',num2str(param.beta*100),'.png'), 'Resolution', 600);


        f = figure(151);
        plot((0:param.max_turns)',100*res_prop, 'blue', 'LineWidth', 5);
        hold on
        plot((0:param.max_turns)',100*res_std, 'black:', 'LineWidth', 2);
%         plot((0:param.max_turns)',100*res_lin, 'blue-.', 'LineWidth', 1);
%         plot((0:param.max_turns)',100*res_sim, 'color',[0 0.5 0], 'LineStyle',':', 'LineWidth', 2);
        plot((0:param.max_turns)',100*res_sim, 'green--', 'LineWidth', 2);
        hold off
        ytickformat('percentage');
%         axis([0 param.max_turns 50 100]);
        legend('Proposed Model', 'Standard Model', 'Numerical Simulation', 'Location', 'North');
%         title(strcat('2SEIS: (S+S'') population, \alpha=',num2str(param.alpha)));
        xlabel('Turn');
        ylabel('Percentage of Total Devices');
        exportgraphics(f,strcat('Paper_2seis_compare_a', num2str(param.alpha*100),'_b',num2str(param.beta*100),'.png'), 'Resolution', 600);

        f = figure(152);
        plot((0:param.max_turns)',abs(100*error_prop), 'blue', 'LineWidth', 4);
%         plot((0:param.max_turns)',100*error_prop, 'red', 'LineWidth', 3);
        hold on;
        plot((0:param.max_turns)',100*error_std, 'black:', 'LineWidth', 2);
%         plot((0:param.max_turns)',100*error_lin, 'blue-.', 'LineWidth', 1);
        hold off
        ytickformat('percentage');
%         set(gca, 'YScale', 'log')
%         plot((0:param.max_turns)',100*zeros(1,param.max_turns+1), 'green', 'LineWidth', 2);
        axis([0 param.max_turns -1 11]);
        legend('Proposed Model', 'Standard Model', 'Location', 'East');
%         title(strcat('2SEIS: (S+S'') error between simulation and DTMC, \alpha=',num2str(param.alpha)));
        xlabel('Turn');
        ylabel('Percentage of Total Devices');
        exportgraphics(f,strcat('Paper_2seis_error_a', num2str(param.alpha*100),'_b',num2str(param.beta*100),'.png'), 'Resolution', 600);
        
        clearvars f;
        
end
