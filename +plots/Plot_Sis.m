t = param.max_turns

% f = figure(5);
% % figure
% plot(report(1:t+1,1),100*report(1:t+1,2)/param.n, 'LineWidth', 2);
% hold on;
% plot(report(1:t+1,1),100*report(1:t+1,3)/param.n, 'LineWidth', 2);
% hold off;
% ytickformat('percentage');
% % axis([0 1 0 1]);
% axis([0 param.max_turns 0 100]);
% legend('Susceptible','Infectious', 'Location', 'North');
% title(strcat('Simulation, \alpha=', num2str(param.alpha),', \beta=',num2str(param.beta),', G=',num2str(param.G)));
% xlabel('Turn');
% ylabel('Percentage of Total Devices');
% print('-djpeg90','-r300',strcat(datestr(now,29),'_SIS_SIMUL_',num2str(param.alpha*100),num2str(param.beta*100),'_',num2str(param.G),'.jpg'));

% f = figure(6);
% % figure
% plot(0:t,100*report(1:t+1,2)/param.n, 'blue', 'LineWidth', 2);
% hold on;
% plot(0:t,100*report(1:t+1,3)/param.n, 'red', 'LineWidth', 2);
% plot(1:t,100*cleaned/param.n, 'color',[0 0.5 0], 'LineWidth', 2);
% plot(1:t,100*false_pos/param.n, 'color',[1 0.7 0.3], 'LineWidth', 2);
% plot(1:t,100*reset/param.n, 'black', 'LineWidth', 2);
% hold off;
% ytickformat('percentage');
% % axis([0 1 0 1]);
% axis([0 param.max_turns 0 100]);
% legend('Susceptible', 'Infected', 'Detected', 'False Positive', 'Reset', 'Location', 'North');
% 
% title(strcat('SIM: \alpha=', num2str(param.alpha),', \beta=',  num2str(param.beta), ', FPR=',num2str(param.FPR),', FNR=', num2str(1-param.beta), ', G=',num2str(param.G)), 'FontSize', 16);
% % title(strcat('Simulation, \alpha=', num2str(param.alpha),', \beta=',num2str(param.beta),', G=',num2str(param.G)), 'FontSize', 16);
% xlabel('Turn');
% ylabel('Percentage of Total Devices');
% print('-djpeg90','-r300',strcat('FIG_sis_simul_a', num2str(param.alpha*100),'_b',num2str(param.beta*100),'_fpr',num2str(param.FPR*100),'_g',num2str(param.G),'_cost.jpg'));



f = figure(6);
% figure
plot(0:t,100*report(1:t+1,2)/param.n, 'blue', 'LineWidth', 2);
hold on;
plot(0:t,100*report(1:t+1,3)/param.n, 'red', 'LineWidth', 2);
plot(1:t,100*report_turn.cleanings/param.n, 'color',[0 0.5 0], 'LineWidth', 2);
plot(1:t,100*report_turn.resets/param.n, 'black--', 'LineWidth', 2);
hold off;
ytickformat('percentage');
% axis([0 1 0 1]);
axis([0 param.max_turns 0 100]);
legend('Susceptible', 'Infected', 'Detected', 'Resets', 'Location', 'North');
title(strcat('\alpha=', num2str(param.alpha), ' \beta=', num2str(param.beta), ' Automatic'), 'FontSize', 16);
% title(strcat('Simulation, \alpha=', num2str(param.alpha),', \beta=',num2str(param.beta),', G=',num2str(param.G)), 'FontSize', 16);
xlabel('Turn');
ylabel('Percentage of Total Devices');
exportgraphics(f, strcat(nameParam, '.png'), 'Resolution', 600);
clearvars f;
% print('-dpng',strcat('sis_simul_a', num2str(param.alpha*100),'_b',num2str(param.beta*100),'_fpr',num2str(param.FPR*100),'_g',num2str(param.G),'_cost.png'));




% f = figure(7);
% % figure
% plot(1:t,100*report_turn.false_neg/param.n, 'LineWidth', 2);
% % plot(1:t,100*false_neg/param.n, 'red', 'LineWidth', 2);
% hold on;
% plot(1:t,100*report_turn.false_neg_M/param.n, '.', 'LineWidth', 2);
% plot(1:t,100*report_turn.false_pos/param.n, '--', 'LineWidth', 2);
% % plot(1:t,100*false_pos/param.n, 'color',[0 0.5 0], 'LineWidth', 2);
% hold off;
% ytickformat('percentage');
% % axis([0 1 0 1]);
% % axis([0 param.max_turns 0 100]);
% legend('False Negatives', 'Mitigated False Negatives', 'False Positives', 'Location', 'North');
% 
% title(strcat('SIM: FPR =',num2str(param.FPR),', FNR=', num2str(1-param.beta),', G=',num2str(param.G)), 'FontSize', 16);
% % title(strcat('Simulation, \alpha=', num2str(param.alpha),', \beta=',num2str(param.beta),', G=',num2str(param.G)), 'FontSize', 16);
% xlabel('Turn');
% ylabel('Percentage of Total Devices');
% print('-djpeg90','-r300',strcat('FIG_sis_simul_a', num2str(param.alpha*100),'_b',num2str(param.beta*100),'_fpr',num2str(param.FPR*100),'_g',num2str(param.G),'_falseposneg.jpg'));


% axis([0 param.max_turns 0 100]);
% print('-djpeg90','-r300',strcat(datestr(now,29),'_SIS_SIMUL_',num2str(param.alpha*100),num2str(param.beta*100),'_',num2str(param.G),'_COST.jpg'));

% f = figure(6);
% % figure
% plot(report(1:t,1),report(1:t,2), 'LineWidth', 2);
% hold on;
% plot(report(1:t,1),report(1:t,8), 'LineWidth', 2);
% hold off;
% ytickformat('percentage');
% axis([0 param.max_turns 0 100*param.n]);
% title('Clean Devices');
% legend('Clean devices', 'Dev report_turn.resetsting', 'Location', 'North');
% xlabel('Turn');
% ylabel('Number of Devices');
% print('-djpeg90','-r300','IMG_MSM_clean');
% 
% f = figure(7);
% % figure
% plot(report(1:t,1),report(1:t,3), 'LineWidth', 2);
% hold on;
% plot(report(1:t,1),report(1:t,8), 'LineWidth', 2);
% hold off;
% ytickformat('percentage');
% axis([0 param.max_turns 0 100*param.n]);
% title('MSM Infected Devices');
% legend('Infectious', 'Dev report_turn.resetsting', 'Location', 'East');
% xlabel('Turn');
% ylabel('Number of Devices');
% print('-djpeg90','-r300','IMG_MSM_infected');