function [Pt_next, Inf, Mit, D, C] = MarkovChainSis(Pt, mcModel, N, alpha, beta, G)

% S = Susceptible population
% I = Infected population

% Inf = New infections
% Mit = New cleanings of infected
% D = Infections detected
% C = Resets performed (regardless of infected or not)

% G - Mitigation multiplicator, for every detected infection, clean G other random devices (see paper)

S = Pt(1);
I = Pt(2);

switch(mcModel)
                   
    case 'proposed'

        %%% Proposed exact nonlinear model
        
        Inf = S - S * ((1 - (alpha/N)) ^ (I*N));
        Mit = beta * I * (1 + G * I * (1-beta));
        D = beta*I;
        C = (1+G)*beta*I;
        if C>1
            C = 1;
        end

    
    case 'standard'

        %%% Standard nonlinear model in literature

        Inf = alpha*S*I;
        Mit = beta*I;
        D = beta*I;
        C = D;

        
    case 'linear'
        
        %%% Standard linear model in literature

        Inf = alpha*S;
        Mit = beta*I;
        D = beta*I;
        C = D;
        
        
    case 'onlyInfection'
        
        %%% Only infection term of proposed exact nonlinear model
        
        Inf = S - S*((1 - (alpha/N))^(I*N));
        Mit = 0;
        D = 0;
        C = 0;
        
        
    case 'onlyMitigation'

        %%% Only mitigation term of proposed exact nonlinear model
        
        Inf = 0;
        Mit = beta*I*(1 + G*I*(1-beta));
        D = beta*I;
        C = (1+G)*beta*I/N;
        
        
    case 'combinatory3rd'
        
        SecondTerm = alpha*(S*I);
        ThalphadFactorial = nchoosek(round(I*N),2);
        ThalphadTerm = ThalphadFactorial*S/N^2;
        
        Inf = SecondTerm - ThalphadTerm;
        Mit = beta*I;
        D = beta*I;
        C = D;
        
        
    case 'module'

        %%% Exact model based on module of (I-S)
        
        g = I - S; % I-S
        e = S - I; % S-I
        g_plus = g*(abs(g)-g)/(2*e);
        
        Inf = alpha*(g_plus + S);
        Mit = beta*I;
        D = beta*I;
        C = D;


    case 'InfectionExact'

        %%% Proposed exact nonlinear model with simple mitigation (no group mitigation)
        
        Inf = S - S*((1 - (alpha/N))^(I*N));
        Mit = beta*I;
        D = beta*I;
        C = D;

                
    case 'InfecMitigExactInBetween'

        %%% Tentative proposed exact nonlinear model (some problems, substituted by first model in the top of page)
        
        Inf = S - S*((1 - (alpha/N))^(I*N));
        Inf
        M1 = 1/G - (1/G)*(( 1 - beta*(G*I/N) )^(I*N));
        M1
        M2 = I-1/N - (I-1/N)*(( 1 - beta*(G*I/N) )^(I*N));
        M2
%         M1 = (1/G)*(-1)^(I*N) + (1/G)*(( 1 - beta*(G*I/N) )^(I*N));
%         M2 = (I-1/N)*(-1)^(I*N) + (I-1/N)*(( 1 - beta*(G*I/N) )^(I*N));
        Mit = M1 + M2;
        Mit
        D = beta*I;
        C = 0.5;

end

        
dPt = [(- Inf  + Mit);
       (  Inf  - Mit)];

Pt_next = Pt + dPt;
        
end
