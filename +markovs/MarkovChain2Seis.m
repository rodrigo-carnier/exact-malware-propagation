function [Pt, Inf1, Inf2, Mit1, Mit2, Detec, Cleand] = MarkovChain2Seis(Pt, mcModel, N0, alpha, beta, G, omega, i)



% S1 = Susceptible population no exposable
% I1 = Infected population no exposable
% S2 = Susceptible population exposable
% E2 = Exposed population
% I2 = Infected population no exposable

% S_omega = Susceptible population at "omega" turns ago (for exposed dealy)
% I_omega = Infected population at "omega" turns ago (for exposed dealy)

% G - Mitigation multiplicator, for every detected infection, clean G other random devices (see paper)

% Inf1 = New infections, devices just became Exposed
% Inf2 = Infection delay finished, devices just became Infected
% Mit1 = New cleanings, devices just became Recovered
% Mit2 = Cleaning delay finished, devices just became Susceptible


S1 = Pt(1,i-1);
I1 = Pt(2,i-1);
S2 = Pt(3,i-1);
E2 = Pt(4,i-1);
I2 = Pt(5,i-1);
N = (S1 +I1 + S2 + E2 + I2)*N0;

I1_omega = Pt(2,i-1-omega);
S2_omega = Pt(3,i-1-omega);
I2_omega = Pt(5,i-1-omega);

switch(mcModel)
                   
    case 'proposed'

        %%% Proposed exact nonlinear model
        
        Inf1 = (S1 - S1 * ((1-(alpha/N))^((I1+I2)*N)));
        Inf2 = (S2 - S2 * ((1-(alpha/N))^((I1+I2)*N)));
        Inf3 = S2_omega - S2_omega * ((1-(alpha/N))^((I1_omega+I2_omega)*N));

        Mit1 = beta * I1;
        Mit2 = beta * I2;

        Detec = Mit1+Mit2;
        Cleand = Mit1+Mit2;
        if Cleand >1
            Cleand = 1;
        end
        
    case 'standard'

        %%% Standard nonlinear model
        
        Inf1 = alpha*S1*(I1+I2);
        Inf2 = alpha*S2*(I1+I2);
        Inf3 = alpha*S2_omega*(I1_omega+I2_omega);

        Mit1 = beta * I1;
        Mit2 = beta * I2;

        Detec = Mit1+Mit2;
        Cleand = Mit1+Mit2;
        if Cleand >1
            Cleand = 1;
        end
        
end

dPt = [( - Inf1 + Mit1 );
       (  Inf1 - Mit1 );
       ( - Inf2 + Mit2 );
       (  Inf2 - Inf3);
       (  Inf3 - Mit2 )];

Pt(:,i) = Pt(:,i-1) + dPt;

end
