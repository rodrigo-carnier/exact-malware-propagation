function [Pt, Inf1, Inf2, Mit1, Mit2, Detec, Cleand] = MarkovChainSeirs(Pt, mcModel, N0, alpha, beta, G, omega, tau, epsilon, i)

% S - Susceptible population
% E - Exposed population
% I - Infected population
% R - Recovered population
% D - Dead population

% S_omega - Susceptible population at "omega" turns ago (for exposed dealy)
% I_omega - Infected population at "omega" turns ago (for exposed dealy)
% I_tau - Infected population at "tau" turns ago (for recovered dealy)

% G - Mitigation multiplicator, for every detected infection, clean G other random devices (see paper)

% Inf1 - New infections, devices just became Exposed
% Inf2 - Infection delay finished, devices just became Infected
% Mit1 - New cleanings, devices just became Recovered
% Mit2 - Cleaning delay finished, devices just became Susceptible

S = Pt(1,i-1);
E = Pt(2,i-1);
I = Pt(3,i-1);
R = Pt(4,i-1);
D = Pt(5,i-1);
N = (S + I + R + E)*N0;

S_omega = Pt(1,i-1-omega);
I_omega = Pt(3,i-1-omega);
I_tau = Pt(3,i-1-tau);

switch(mcModel)

    case 'proposed'

        %%% Proposed exact nonlinear model
        
        Inf1 = S - S * ((1-(alpha/N))^(I*N));
        Inf2 = S_omega - S_omega * ((1-(alpha/N))^(I_omega*N));

        Mit1 = beta * I * (1 + G * I * (1-beta));
        Mit2 = beta * I_tau * (1 + G * I_tau * (1-beta));

        Death = epsilon * I;
        
        Detec = beta*I;
        Cleand = (1+G)*beta*I;
        if Cleand >1
            Cleand = 1;
        end

    case 'standard'

        %%% Standard nonlinear model
        
        Inf1 = alpha*S*I;
        Inf2 = alpha*S_omega*I_omega;

        Mit1 = beta * I;
        Mit2 = beta * I_tau;

        Death = epsilon * I;
        
        Detec = beta*I;
        Cleand = (1+G)*beta*I;
        if Cleand >1
            Cleand = 1;
        end
        
end

dPt = [(- Inf1 + Mit2);
       (  Inf1 - Inf2);
       (  Inf2 - Mit1 - Death);
       (  Mit1 - Mit2);
       (  Death)];

Pt(:,i) = Pt(:,i-1) + dPt;

end
