[errorOg, errorSt, deltaD] = mitigmodels.EvaluateErrorDeltaI(smoothdata(estimate.D));
% [errorOg, errorSt, deltaD] = mitigmodels.EvaluateDeltaI(0.125*report(:,3)');


f = figure(6);
% figure
plot(100*estimate.D/param.n);
hold on;
plot(100*param.beta*report(:,3)/param.n);
hold off;
ytickformat('percentage');
% axis([0 1 0 1]);
% axis([0 param.max_turns 0 100]);
legend('Detections', 'Expected Dectecions', 'Location', 'North');
title(strcat('Detected devices, \alpha=', num2str(param.alpha), ' \beta=', num2str(param.beta), ' Automatic'), 'FontSize', 16);
% title(strcat('Simulation, \alpha=', num2str(param.alpha),', \beta=',num2str(param.beta),', G=',num2str(param.G)), 'FontSize', 16);
xlabel('Turn');
ylabel('Percentage of Total Devices');
exportgraphics(f, strcat(datestr(now,29),'_ComparingDetections', '.png'), 'Resolution', 600);
clearvars f;



f = figure(7);
% figure
plot(100*deltaD/param.n);
% hold on;
% plot(100*errorOg/param.n);
% plot(100*errorSt/param.n);
% hold off;
ytickformat('percentage');
% axis([0 1 0 1]);
% axis([0 param.max_turns 0 100]);
legend('\Delta I', 'Location', 'North');
title(strcat('Variation of I, \alpha=', num2str(param.alpha), ' \beta=', num2str(param.beta), ' Automatic'), 'FontSize', 16);
% title(strcat('Simulation, \alpha=', num2str(param.alpha),', \beta=',num2str(param.beta),', G=',num2str(param.G)), 'FontSize', 16);
xlabel('Turn');
ylabel('Percentage of Total Devices');
exportgraphics(f, strcat(datestr(now,29),'_DeltaD', '.png'), 'Resolution', 600);
clearvars f;


f = figure(8);
% figure
plot(100*errorOg/param.n);
hold on;
plot(100*errorSt/param.n);
hold off;
ytickformat('percentage');
% axis([0 1 0 1]);
% axis([0 param.max_turns 0 100]);
legend('Error Exact', 'Error Std', 'Location', 'North');
title('\Delta I error evaluated on D instead of actual I', 'FontSize', 16);
% title(strcat('\Delta I error between Exact and Std models evaluated on Detections, \alpha=', num2str(param.alpha), ' \beta=', num2str(param.beta), ' Automatic'), 'FontSize', 16);
% title(strcat('Simulation, \alpha=', num2str(param.alpha),', \beta=',num2str(param.beta),', G=',num2str(param.G)), 'FontSize', 16);
xlabel('Turn');
ylabel('Percentage of Total Devices');
exportgraphics(f, strcat(datestr(now,29),'_DeltaI', '.png'), 'Resolution', 600);
clearvars f;