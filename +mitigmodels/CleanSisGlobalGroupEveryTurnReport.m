function [network_k1_cleaned, report_SIS_inf, report_SIQ_inf] = CleanSisGlobalGroupEveryTurnReport(network, param)

% This implementation of group mitigation chooses and cleans G additional
% devices after every detection, instead of choosing and cleaning beta*I*(G+1)
% once after scanning all devices.
% Therefore, this implementation incurs in TWO mechanisms of inneficiency,
% similar to random propagation: targetting clean devices and repeating
% cleanings. The implementation of group mitigation only once at the end of
% the scanning incurs in only ONE mechanism: targetting clean devices.
% Therefore this latter implementation is the standard one.

% Initialize new matrix
network_k1_cleaned = network;

report_SIS_inf = [];
report_SIQ_inf = [];

switch param.malware
    
    case 'SIS'

        cleaned = 0;
        report_SIS_inf = 0;
        
        [addressInfected, numberInfected] = GetSenderGlobalInfected(network, 'SIS');
        
        for dev_add=1:numberInfected

            if rand(1)<=param.DR
                cleaned = cleaned + 1;
                report_SIS_inf = [report_SIS_inf; dev_add];
                devicesByGroup = GetDevicesByGroupBlock(addressInfected(dev_add), param.G);
                vectorOfDevices = nonzeros(devicesByGroup);

                for j=1:size(vectorOfDevices,1)
%                     network_k1_cleaned(2,vectorOfDevices(j)) = -1;
                    network_k1_cleaned(3,vectorOfDevices(j)) = 0;
                end

            end

        end
        
        numberInfected
        cleaned
        
        
    case 'SIQ'

        cleaned = 0;
        report_SIQ_inf = 0;
        
        [addressInfected, numberInfected] = GetSenderGlobalInfected(network, 'SIQ');
        
        for dev_add=1:numberInfected

            if rand(1)<=param.DR
                cleaned = cleaned + 1;
                report_SIQ_inf = [report_SIQ_inf; dev_add];
                devicesByGroup = GetDevicesByGroupBlock(addressInfected(dev_add), param.G);
                vectorOfDevices = nonzeros(devicesByGroup);

                for j=1:size(vectorOfDevices,1)
                    network_k1_cleaned(2,vectorOfDevices(j)) = 0;
                    network_k1_cleaned(3,vectorOfDevices(j)) = 0;
                end

            end

        end
        
        numberInfected
        cleaned

end

end