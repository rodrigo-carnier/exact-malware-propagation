function network_k1_cleaned = CleanSisGlobal(network, param)

% Initialize new matrix
network_k1_cleaned = network;

switch param.malware
    
    case 'SIS'

        cleaned = 0;
        
        [addressInfected, numberInfected] = GetSenderGlobalInfectedVector(network, 'SIS');
        
        for dev_add=1:numberInfected

            if rand(1)<=param.DR
                cleaned = cleaned + 1;
                devicesByDepth = GetDevicesByDepthBlock(addressInfected(dev_add), param.depth);
                vectorOfDevices = nonzeros(devicesByDepth);

                for j=1:size(vectorOfDevices,1)
                    network_k1_cleaned(3,vectorOfDevices(j)) = 0;
                end

            end
                
        end
        
%         numberInfected
%         cleaned
        
   
    case 'SIQ'
        
        cleaned = 0;
        
        [addressInfected, numberInfected] = GetSenderGlobalInfectedVector(network, 'SIQ');
        
        for dev_add=1:numberInfected
        
            if rand(1)<=param.DR
                cleaned = cleaned + 1;
                devicesByDepth = GetDevicesByDepthBlock(addressInfected(dev_add), param.depth);
                vectorOfDevices = nonzeros(devicesByDepth);

                for j=1:size(vectorOfDevices,1)
                    network_k1_cleaned(2,vectorOfDevices(j)) = 0;
                    network_k1_cleaned(3,vectorOfDevices(j)) = 0;
                end

            end

        end
        
%         numberInfected
%         cleaned
       
end

end